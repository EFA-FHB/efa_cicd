name: is_docker_push_allowed
description: "Checks the Github environment to determine if a Docker image can be pushed"

outputs:
  result:
    description: "Indicator of whether the image can be pushed"
    value: "${{ steps.check_push_allowed.outputs.result }}"


runs:
  using: "composite"

  steps:
    - name: check_push_allowed
      id: check_push_allowed
      shell: bash
      run: |
        result=false
        [[ $(printenv PUSH_IMAGE) == "true" ]] && result=true;
        [[ $(printenv GITHUB_REF) =~ main|release/.+|tags/.+ ]] && result=true;
        echo "::set-output name=result::$result"